import { useEffect } from "react";
import { useParams } from "react-router-dom";
import { useDispatch, useSelector } from "react-redux";
import { fetchProductById } from "../../store/shop/productsSlice";
import { addToCart } from "../../store/shop/cartSlice";

const ProductItem = () => {
  const { productId } = useParams();
  const dispatch = useDispatch();
  const { product, isLoading, error } = useSelector(
    (state) => state.shoppingProducts
  );
  const user = useSelector((state) => state.auth.user);
  console.log("User:", user);

  const handleAddtoCart = (productId) => {
    console.log(`Adding product ${productId} to cart`);
    dispatch(addToCart({ userId: user.id, productId, quantity: 1 })).then(
      (data) => console.log(data)
    );
  };
  useEffect(() => {
    dispatch(fetchProductById(productId));
  }, [dispatch, productId]);

  if (isLoading) return <div>Loading product...</div>;
  if (error) return <div>Error: {error}</div>;
  if (!product) return <div>No product found</div>;

  return (
    <div>
      <div className="flex p-6 md:p-0 flex-col items-center justify-center lg:items-start lg:flex-row lg:m-8">
        <img
          src={product.image}
          alt={product.title}
          className="object-cover hidden md:block w-24 mr-8 border border-gray-300"
        />
        <div className=" w-2/3 lg:w-1/3">
          <img
            src={product.image}
            alt={product.title}
            className="object-cover"
          />
        </div>
        <div className="flex flex-col my-5 lg:ml-12 lg:my-0 lg:w-2/3">
          <h1 className="my-2 text-2xl font-semibold uppercase lg:my-0">
            {product.title}
          </h1>
          <h1 className="pb-2 mb-2 capitalize border-b border-gray-300 border-dashed">
            {product.category}
          </h1>
          <div className="flex items-center justify-start ml-0">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="green"
              className="text-green-500 size-6">
              <path
                fillRule="evenodd"
                d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z"
                clipRule="evenodd"
              />
            </svg>

            <h1 className="mx-2 font-semibold text-gray-600">
              {product.rating} rating
            </h1>
          </div>
          <div className="flex items-center gap-2 mt-4">
            <h1 className="text-3xl ">â‚¹{product.price}</h1>
            <h1 className="text-green-600 ">Special Price</h1>
          </div>
          <h1 className="text-sm text-gray-600">Inclusive of all taxes</h1>
          <div className="flex mt-4 space-x-2">
            {product.size &&
            product.size.length > 0 &&
            product.size[0] !== "" ? (
              product.size.map((size, index) => (
                <span
                  key={index}
                  className="w-12 h-12 py-2 text-lg font-medium text-center text-gray-700 border border-gray-500 rounded-full cursor-pointer hover:bg-gray-700 hover:text-white">
                  {size}
                </span>
              ))
            ) : (
              <h1>Free Size</h1>
            )}
          </div>
          <h1 className="mt-6 text-xl font-semibold">About the product</h1>
          <h1 className="text-base lg:w-[700px] text-justify">
            {product.description}
          </h1>
          <div className="">
            <button
              onClick={() => handleAddtoCart(product?.id)}
              className="flex items-center px-4 py-2 my-4 text-white border lg:px-8 bg-slate-700 hover:text-gray-700 hover:bg-white hover:border-slate-800">
              <span className="pr-2">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                  className="size-6">
                  <path
                    fillRule="evenodd"
                    d="M7.5 6v.75H5.513c-.96 0-1.764.724-1.865 1.679l-1.263 12A1.875 1.875 0 0 0 4.25 22.5h15.5a1.875 1.875 0 0 0 1.865-2.071l-1.263-12a1.875 1.875 0 0 0-1.865-1.679H16.5V6a4.5 4.5 0 1 0-9 0ZM12 3a3 3 0 0 0-3 3v.75h6V6a3 3 0 0 0-3-3Zm-3 8.25a3 3 0 1 0 6 0v-.75a.75.75 0 0 1 1.5 0v.75a4.5 4.5 0 1 1-9 0v-.75a.75.75 0 0 1 1.5 0v.75Z"
                    clipRule="evenodd"
                  />
                </svg>{" "}
              </span>
              Add to Bag
            </button>
          </div>
          <div className="flex items-center pt-2 border-t border-gray-300 border-dashed">
            <svg
              width="20"
              height="20"
              viewBox="0 0 20 20"
              fill="none"
              className="my-2"
              xmlns="http://www.w3.org/2000/svg">
              <path
                d="M7 11L8.5 12.5L13.5 8"
                stroke="black"
                strokeWidth="1.5"></path>
              <rect
                x="2"
                y="5"
                width="16"
                height="12"
                rx="0.5"
                stroke="black"
                strokeWidth="1.5"></rect>
              <path
                d="M2 5.5L3.85604 2.25193C3.94506 2.09614 4.11073 2 4.29016 2H15.2427C15.4042 2 15.5557 2.07798 15.6496 2.20938L18 5.5"
                stroke="black"
                strokeWidth="1.5"></path>
              <path
                d="M7.5 5L8.5 2H11L12 5H7.5Z"
                stroke="black"
                strokeWidth="1.5"></path>
            </svg>
            <h1 className="mx-2 text-sm font-semibold">
              Easy 30 days returns on all orders
            </h1>
          </div>
          <div className="flex items-center">
            <svg
              width="20"
              height="20"
              viewBox="0 0 16 12"
              fill="none"
              className="my-2"
              xmlns="http://www.w3.org/2000/svg">
              <mask id="path-1-inside-1_369_18955" fill="white">
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M0.0498047 1.0498C0.0498047 0.49752 0.49752 0.0498047 1.0498 0.0498047H10.0498C10.6021 0.0498047 11.0498 0.497519 11.0498 1.0498V2.2498H12.439C13.0486 2.2498 13.6143 2.56707 13.9322 3.08726L15.493 5.64136C15.661 5.91612 15.7498 6.23189 15.7498 6.55389V7.9998C15.7498 8.9663 14.9663 9.7498 13.9998 9.7498H13.8854C13.5668 10.7641 12.6192 11.4998 11.4998 11.4998C10.3804 11.4998 9.43282 10.7641 9.11425 9.7498H6.88535C6.56679 10.7641 5.61921 11.4998 4.4998 11.4998C3.39887 11.4998 2.46415 10.7882 2.13054 9.7998H1.0498C0.497521 9.7998 0.0498047 9.35209 0.0498047 8.7998V1.0498ZM9.11425 8.2498C9.20842 7.95 9.35754 7.67453 9.5498 7.43521V1.5498H1.5498V8.2998H2.09912C2.40186 7.25979 3.36208 6.4998 4.4998 6.4998C5.61921 6.4998 6.56679 7.23552 6.88535 8.2498H9.11425ZM11.0498 6.54019C11.1958 6.51366 11.3462 6.4998 11.4998 6.4998C12.6192 6.4998 13.5668 7.23552 13.8854 8.2498H13.9998C14.1379 8.2498 14.2498 8.13787 14.2498 7.9998V6.55389C14.2498 6.50789 14.2371 6.46278 14.2131 6.42353L12.6523 3.86944C12.6069 3.79513 12.5261 3.7498 12.439 3.7498H11.0498V6.54019ZM4.4998 9.9998C5.05209 9.9998 5.4998 9.55209 5.4998 8.9998C5.4998 8.44752 5.05209 7.9998 4.4998 7.9998C3.94752 7.9998 3.4998 8.44752 3.4998 8.9998C3.4998 9.55209 3.94752 9.9998 4.4998 9.9998ZM12.4998 8.9998C12.4998 9.55209 12.0521 9.9998 11.4998 9.9998C10.9475 9.9998 10.4998 9.55209 10.4998 8.9998C10.4998 8.44752 10.9475 7.9998 11.4998 7.9998C12.0521 7.9998 12.4998 8.44752 12.4998 8.9998Z"></path>
              </mask>
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M0.0498047 1.0498C0.0498047 0.49752 0.49752 0.0498047 1.0498 0.0498047H10.0498C10.6021 0.0498047 11.0498 0.497519 11.0498 1.0498V2.2498H12.439C13.0486 2.2498 13.6143 2.56707 13.9322 3.08726L15.493 5.64136C15.661 5.91612 15.7498 6.23189 15.7498 6.55389V7.9998C15.7498 8.9663 14.9663 9.7498 13.9998 9.7498H13.8854C13.5668 10.7641 12.6192 11.4998 11.4998 11.4998C10.3804 11.4998 9.43282 10.7641 9.11425 9.7498H6.88535C6.56679 10.7641 5.61921 11.4998 4.4998 11.4998C3.39887 11.4998 2.46415 10.7882 2.13054 9.7998H1.0498C0.497521 9.7998 0.0498047 9.35209 0.0498047 8.7998V1.0498ZM9.11425 8.2498C9.20842 7.95 9.35754 7.67453 9.5498 7.43521V1.5498H1.5498V8.2998H2.09912C2.40186 7.25979 3.36208 6.4998 4.4998 6.4998C5.61921 6.4998 6.56679 7.23552 6.88535 8.2498H9.11425ZM11.0498 6.54019C11.1958 6.51366 11.3462 6.4998 11.4998 6.4998C12.6192 6.4998 13.5668 7.23552 13.8854 8.2498H13.9998C14.1379 8.2498 14.2498 8.13787 14.2498 7.9998V6.55389C14.2498 6.50789 14.2371 6.46278 14.2131 6.42353L12.6523 3.86944C12.6069 3.79513 12.5261 3.7498 12.439 3.7498H11.0498V6.54019ZM4.4998 9.9998C5.05209 9.9998 5.4998 9.55209 5.4998 8.9998C5.4998 8.44752 5.05209 7.9998 4.4998 7.9998C3.94752 7.9998 3.4998 8.44752 3.4998 8.9998C3.4998 9.55209 3.94752 9.9998 4.4998 9.9998ZM12.4998 8.9998C12.4998 9.55209 12.0521 9.9998 11.4998 9.9998C10.9475 9.9998 10.4998 9.55209 10.4998 8.9998C10.4998 8.44752 10.9475 7.9998 11.4998 7.9998C12.0521 7.9998 12.4998 8.44752 12.4998 8.9998Z"
                fill="white"></path>
              <path
                d="M11.0498 2.2498H9.5498V3.7498H11.0498V2.2498ZM13.9322 3.08726L15.2121 2.30509V2.30509L13.9322 3.08726ZM15.493 5.64136L16.773 4.85919L16.773 4.85918L15.493 5.64136ZM13.8854 9.7498V8.2498H12.7842L12.4543 9.30033L13.8854 9.7498ZM9.11425 9.7498L10.5453 9.30033L10.2154 8.2498H9.11425V9.7498ZM6.88535 9.7498V8.2498H5.78423L5.45428 9.30033L6.88535 9.7498ZM2.13054 9.7998L3.55176 9.32009L3.20738 8.2998H2.13054V9.7998ZM9.5498 7.43521L10.7192 8.37466L11.0498 7.96311V7.43521H9.5498ZM9.11425 8.2498V9.7498H10.2154L10.5453 8.69928L9.11425 8.2498ZM9.5498 1.5498H11.0498V0.0498047H9.5498V1.5498ZM1.5498 1.5498V0.0498047H0.0498047V1.5498H1.5498ZM1.5498 8.2998H0.0498047V9.7998H1.5498V8.2998ZM2.09912 8.2998V9.7998H3.22475L3.53935 8.71904L2.09912 8.2998ZM6.88535 8.2498L5.45428 8.69928L5.78423 9.7498H6.88535V8.2498ZM11.0498 6.54019H9.5498V8.33742L11.3181 8.01601L11.0498 6.54019ZM13.8854 8.2498L12.4543 8.69928L12.7842 9.7498H13.8854V8.2498ZM14.2131 6.42353L12.9332 7.20571L12.9332 7.20572L14.2131 6.42353ZM12.6523 3.86944L11.3724 4.65161L11.3724 4.65161L12.6523 3.86944ZM11.0498 3.7498V2.2498H9.5498V3.7498H11.0498ZM1.0498 -1.4502C-0.330907 -1.4502 -1.4502 -0.330907 -1.4502 1.0498H1.5498C1.5498 1.32595 1.32595 1.5498 1.0498 1.5498V-1.4502ZM10.0498 -1.4502H1.0498V1.5498H10.0498V-1.4502ZM12.5498 1.0498C12.5498 -0.330909 11.4305 -1.4502 10.0498 -1.4502V1.5498C9.77366 1.5498 9.5498 1.32595 9.5498 1.0498H12.5498ZM12.5498 2.2498V1.0498H9.5498V2.2498H12.5498ZM12.439 0.749802H11.0498V3.7498H12.439V0.749802ZM15.2121 2.30509C14.6218 1.33901 13.5712 0.749802 12.439 0.749802V3.7498C12.5261 3.7498 12.6069 3.79513 12.6523 3.86944L15.2121 2.30509ZM16.773 4.85918L15.2121 2.30509L12.6523 3.86944L14.2131 6.42353L16.773 4.85918ZM17.2498 6.55389C17.2498 5.95588 17.0848 5.36946 16.773 4.85919L14.2131 6.42353C14.2371 6.46279 14.2498 6.5079 14.2498 6.55389H17.2498ZM17.2498 7.9998V6.55389H14.2498V7.9998H17.2498ZM13.9998 11.2498C15.7947 11.2498 17.2498 9.79473 17.2498 7.9998H14.2498C14.2498 8.13787 14.1379 8.2498 13.9998 8.2498V11.2498ZM13.8854 11.2498H13.9998V8.2498H13.8854V11.2498ZM11.4998 12.9998C13.2931 12.9998 14.8071 11.8208 15.3164 10.1993L12.4543 9.30033C12.3264 9.7074 11.9453 9.9998 11.4998 9.9998V12.9998ZM7.68318 10.1993C8.19246 11.8208 9.70648 12.9998 11.4998 12.9998V9.9998C11.0543 9.9998 10.6732 9.7074 10.5453 9.30033L7.68318 10.1993ZM6.88535 11.2498H9.11425V8.2498H6.88535V11.2498ZM4.4998 12.9998C6.29312 12.9998 7.80715 11.8208 8.31643 10.1993L5.45428 9.30033C5.32642 9.7074 4.9453 9.9998 4.4998 9.9998V12.9998ZM0.709319 10.2795C1.2425 11.8591 2.73599 12.9998 4.4998 12.9998V9.9998C4.06175 9.9998 3.6858 9.7172 3.55176 9.32009L0.709319 10.2795ZM1.0498 11.2998H2.13054V8.2998H1.0498V11.2998ZM-1.4502 8.7998C-1.4502 10.1805 -0.330904 11.2998 1.0498 11.2998V8.2998C1.32595 8.2998 1.5498 8.52366 1.5498 8.7998H-1.4502ZM-1.4502 1.0498V8.7998H1.5498V1.0498H-1.4502ZM8.38044 6.49575C8.07343 6.87789 7.83437 7.31894 7.68318 7.80033L10.5453 8.69928C10.5825 8.58105 10.6416 8.47117 10.7192 8.37466L8.38044 6.49575ZM8.0498 1.5498V7.43521H11.0498V1.5498H8.0498ZM1.5498 3.0498H9.5498V0.0498047H1.5498V3.0498ZM3.0498 8.2998V1.5498H0.0498047V8.2998H3.0498ZM2.09912 6.7998H1.5498V9.7998H2.09912V6.7998ZM4.4998 4.9998C2.67725 4.9998 1.143 6.2175 0.6589 7.88057L3.53935 8.71904C3.66072 8.30209 4.04691 7.9998 4.4998 7.9998V4.9998ZM8.31643 7.80033C7.80715 6.17884 6.29312 4.9998 4.4998 4.9998V7.9998C4.9453 7.9998 5.32642 8.29221 5.45428 8.69928L8.31643 7.80033ZM9.11425 6.7498H6.88535V9.7498H9.11425V6.7498ZM11.4998 4.9998C11.2558 4.9998 11.0156 5.02183 10.7816 5.06437L11.3181 8.01601C11.3759 8.00549 11.4366 7.9998 11.4998 7.9998V4.9998ZM15.3164 7.80033C14.8071 6.17884 13.2931 4.9998 11.4998 4.9998V7.9998C11.9453 7.9998 12.3264 8.29221 12.4543 8.69928L15.3164 7.80033ZM13.9998 6.7498H13.8854V9.7498H13.9998V6.7498ZM12.7498 7.9998C12.7498 7.30945 13.3094 6.7498 13.9998 6.7498V9.7498C14.9663 9.7498 15.7498 8.9663 15.7498 7.9998H12.7498ZM12.7498 6.55389V7.9998H15.7498V6.55389H12.7498ZM12.9332 7.20572C12.8133 7.00944 12.7498 6.78388 12.7498 6.55389H15.7498C15.7498 6.2319 15.661 5.91613 15.493 5.64134L12.9332 7.20572ZM11.3724 4.65161L12.9332 7.20571L15.493 5.64136L13.9322 3.08726L11.3724 4.65161ZM12.439 5.2498C12.0035 5.2498 11.5994 5.02319 11.3724 4.65161L13.9322 3.08727C13.6143 2.56706 13.0486 2.2498 12.439 2.2498V5.2498ZM11.0498 5.2498H12.439V2.2498H11.0498V5.2498ZM12.5498 6.54019V3.7498H9.5498V6.54019H12.5498ZM3.9998 8.9998C3.9998 8.72366 4.22366 8.4998 4.4998 8.4998V11.4998C5.88051 11.4998 6.9998 10.3805 6.9998 8.9998H3.9998ZM4.4998 9.4998C4.22366 9.4998 3.9998 9.27594 3.9998 8.9998H6.9998C6.9998 7.61909 5.88051 6.4998 4.4998 6.4998V9.4998ZM4.9998 8.9998C4.9998 9.27594 4.77594 9.4998 4.4998 9.4998V6.4998C3.11909 6.4998 1.9998 7.61909 1.9998 8.9998H4.9998ZM4.4998 8.4998C4.77594 8.4998 4.9998 8.72366 4.9998 8.9998H1.9998C1.9998 10.3805 3.11909 11.4998 4.4998 11.4998V8.4998ZM11.4998 11.4998C12.8805 11.4998 13.9998 10.3805 13.9998 8.9998H10.9998C10.9998 8.72366 11.2237 8.4998 11.4998 8.4998V11.4998ZM8.9998 8.9998C8.9998 10.3805 10.1191 11.4998 11.4998 11.4998V8.4998C11.7759 8.4998 11.9998 8.72366 11.9998 8.9998H8.9998ZM11.4998 6.4998C10.1191 6.4998 8.9998 7.61909 8.9998 8.9998H11.9998C11.9998 9.27594 11.7759 9.4998 11.4998 9.4998V6.4998ZM13.9998 8.9998C13.9998 7.61909 12.8805 6.4998 11.4998 6.4998V9.4998C11.2237 9.4998 10.9998 9.27594 10.9998 8.9998H13.9998Z"
                fill="black"
                mask="url(#path-1-inside-1_369_18955)"></path>
            </svg>
            <h1 className="mx-2 text-sm font-semibold">
              Cash on Delivery available at checkout.
            </h1>
          </div>

          <div className="flex items-center">
            <svg
              width="20"
              height="20"
              viewBox="0 0 10 16"
              fill="none"
              className="my-2"
              xmlns="http://www.w3.org/2000/svg">
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M0 5.05261C0 2.07484 2.26272 0 5 0C7.73728 0 10 2.07484 10 5.05261C10 6.13097 9.67727 6.95382 9.21875 7.77775L5.32407 15.807C5.25883 15.9261 5.13473 16 5 16C4.86527 16 4.74117 15.9261 4.67593 15.807L0.78125 7.77775C0.322735 6.95384 0 6.13097 0 5.05261ZM2.59265 4.90907C2.59265 3.608 3.67487 2.54544 5.00006 2.54544C6.32525 2.54544 7.40747 3.608 7.40747 4.90907C7.40747 6.21016 6.32525 7.27269 5.00006 7.27269C3.67487 7.27269 2.59265 6.21016 2.59265 4.90907Z"
                fill="black"></path>
            </svg>
            <h1 className="mx-2 text-sm font-semibold">
              Free Shipping for all orders
            </h1>
          </div>
        </div>
      </div>
    </div>
  );
};

export default ProductItem;
